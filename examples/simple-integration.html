<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Tienda Online - Ejemplo Chatbot</title>
    <style>
        body {
            font-family: system-ui, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .product {
            border: 1px solid #ddd;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .price {
            font-size: 24px;
            color: #007cba;
            font-weight: bold;
        }
        button {
            background: #007cba;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #005a8b;
        }
        .controls {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            z-index: 1000;
        }
        .controls button {
            display: block;
            width: 100%;
            margin: 5px 0;
        }
        .debug-info {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: #333;
            color: white;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            max-width: 300px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõçÔ∏è Mi Tienda Online</h1>
        <p>Bienvenido a nuestra tienda. Nuestro asistente de ventas est√° aqu√≠ para ayudarte.</p>

        <div class="product">
            <h3>Producto Destacado</h3>
            <p>Descripci√≥n del producto m√°s vendido de la semana.</p>
            <div class="price">$99.99</div>
            <button onclick="addToCart()">Agregar al Carrito</button>
        </div>

        <div class="product">
            <h3>Oferta Especial</h3>
            <p>Producto con descuento limitado por tiempo.</p>
            <div class="price">$79.99 <small style="text-decoration: line-through; color: #666;">$99.99</small></div>
            <button onclick="addToCart()">Aprovechar Oferta</button>
        </div>
    </div>

    <!-- Controles de prueba -->
    <div class="controls">
        <h4>Controles de Prueba</h4>
        <button onclick="loadChatbot()">Cargar Chatbot</button>
        <button onclick="removeChatbot()">Remover Chatbot</button>
        <button onclick="updateTheme()">Cambiar Tema</button>
        <button onclick="testChatbot()">Test B√°sico</button>
    </div>

    <!-- Debug info -->
    <div class="debug-info" id="debug-info">
        <div>Cargando...</div>
    </div>

    <!-- IMPORTANTE: Cargar React ANTES del componente chatbot -->
    <script crossorigin src="https://unpkg.com/react@19/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@19/umd/react-dom.production.min.js"></script>
    
    <!-- Verificar que React est√© disponible antes de cargar el chatbot -->
    <script>
        function updateDebugInfo(message) {
            const debugEl = document.getElementById('debug-info');
            if (debugEl) {
                debugEl.innerHTML = `<div>${new Date().toLocaleTimeString()}: ${message}</div>`;
            }
        }

        // Verificar que React est√© cargado
        if (typeof React === 'undefined') {
            console.error('React no est√° disponible. Aseg√∫rate de que los scripts de React se carguen correctamente.');
            updateDebugInfo('‚ùå React no disponible');
        } else {
            console.log('React cargado correctamente:', React.version);
            updateDebugInfo(`‚úÖ React ${React.version} cargado`);
        }

        if (typeof ReactDOM === 'undefined') {
            console.error('ReactDOM no est√° disponible. Aseg√∫rate de que los scripts de ReactDOM se carguen correctamente.');
            updateDebugInfo('‚ùå ReactDOM no disponible');
        } else {
            console.log('ReactDOM cargado correctamente');
            updateDebugInfo('‚úÖ ReactDOM cargado');
        }
    </script>

    <!-- Cargar el componente chatbot DESPU√âS de React -->
    <script src="../dist/react-chatbot-component.umd.js"></script>

    <!-- Verificar que el componente est√© disponible -->
    <script>
        if (typeof ReactChatbotComponent === 'undefined') {
            console.error('ReactChatbotComponent no est√° disponible.');
            updateDebugInfo('‚ùå ReactChatbotComponent no disponible');
        } else {
            console.log('ReactChatbotComponent cargado correctamente:', ReactChatbotComponent);
            updateDebugInfo('‚úÖ ReactChatbotComponent cargado');
        }
    </script>

    <!-- JavaScript de la aplicaci√≥n -->
    <script>
        let currentChatbot = null;

        // Funci√≥n para cargar el chatbot
        function loadChatbot() {
            // Remover chatbot existente si hay uno
            removeChatbot();

            try {
                updateDebugInfo('üîÑ Cargando chatbot...');
                
                // Crear elemento del chatbot
                const chatbot = document.createElement('react-chatbot');
                
                // Configurar atributos
                chatbot.setAttribute('api-key', 'demo-key-tienda-online');
                chatbot.setAttribute('title', 'Asistente de Ventas');
                chatbot.setAttribute('position', 'bottom-right');
                chatbot.setAttribute('welcome-message', '¬°Hola! Soy tu asistente de ventas. ¬øEn qu√© puedo ayudarte hoy?');
                chatbot.setAttribute('placeholder', 'Escribe tu pregunta aqu√≠...');
                
                // Agregar al DOM
                document.body.appendChild(chatbot);
                currentChatbot = chatbot;
                
                console.log('Chatbot cargado exitosamente');
                updateDebugInfo('‚úÖ Chatbot cargado exitosamente');
            } catch (error) {
                console.error('Error al cargar el chatbot:', error);
                updateDebugInfo(`‚ùå Error: ${error.message}`);
                alert('Error al cargar el chatbot. Revisa la consola para m√°s detalles.');
            }
        }

        // Funci√≥n para remover el chatbot
        function removeChatbot() {
            if (currentChatbot) {
                currentChatbot.remove();
                currentChatbot = null;
                console.log('Chatbot removido');
                updateDebugInfo('üóëÔ∏è Chatbot removido');
            }
        }

        // Funci√≥n para actualizar el tema
        function updateTheme() {
            if (currentChatbot) {
                const themes = [
                    {
                        primary: '#007cba',
                        secondary: '#005a8b',
                        accent: '#4a90e2'
                    },
                    {
                        primary: '#ff6b35',
                        secondary: '#e55a2b',
                        accent: '#ffa500'
                    },
                    {
                        primary: '#28a745',
                        secondary: '#1e7e34',
                        accent: '#20c997'
                    }
                ];
                
                const randomTheme = themes[Math.floor(Math.random() * themes.length)];
                currentChatbot.setAttribute('theme', JSON.stringify(randomTheme));
                console.log('Tema actualizado:', randomTheme);
                updateDebugInfo(`üé® Tema actualizado: ${randomTheme.primary}`);
            } else {
                alert('Primero carga el chatbot');
                updateDebugInfo('‚ö†Ô∏è No hay chatbot para actualizar tema');
            }
        }

        // Funci√≥n de test b√°sico
        function testChatbot() {
            try {
                updateDebugInfo('üß™ Ejecutando test b√°sico...');
                
                // Test 1: Verificar React
                if (typeof React === 'undefined') {
                    throw new Error('React no est√° disponible');
                }
                
                // Test 2: Verificar ReactDOM
                if (typeof ReactDOM === 'undefined') {
                    throw new Error('ReactDOM no est√° disponible');
                }
                
                // Test 3: Verificar componente
                if (typeof ReactChatbotComponent === 'undefined') {
                    throw new Error('ReactChatbotComponent no est√° disponible');
                }
                
                // Test 4: Crear elemento temporal
                const testElement = document.createElement('react-chatbot');
                testElement.setAttribute('api-key', 'test-key');
                
                console.log('‚úÖ Todos los tests b√°sicos pasaron');
                updateDebugInfo('‚úÖ Test b√°sico exitoso');
                
            } catch (error) {
                console.error('‚ùå Test b√°sico fall√≥:', error);
                updateDebugInfo(`‚ùå Test fall√≥: ${error.message}`);
            }
        }

        // Funci√≥n simulada para agregar al carrito
        function addToCart() {
            alert('Producto agregado al carrito. ¬°Preg√∫ntale al chatbot sobre descuentos!');
            updateDebugInfo('üõí Producto agregado al carrito');
        }

        // Cargar el chatbot autom√°ticamente cuando la p√°gina est√© lista
        window.addEventListener('load', function() {
            console.log('P√°gina cargada, iniciando chatbot...');
            updateDebugInfo('üìÑ P√°gina cargada');
            
            // Delay para asegurar que todo est√© cargado
            setTimeout(() => {
                loadChatbot();
            }, 500);
        });

        // Manejo de errores globales
        window.addEventListener('error', function(e) {
            console.error('Error global capturado:', e.error);
            updateDebugInfo(`üö® Error global: ${e.error?.message || 'Error desconocido'}`);
        });

        // Debug inicial
        updateDebugInfo('üöÄ Inicializando...');
    </script>
</body>
</html> 